Index: oxide-qt-1.0.0~bzr514/CMakeLists.txt
===================================================================
--- oxide-qt-1.0.0~bzr514.orig/CMakeLists.txt	2014-04-16 10:05:30.747499138 +0100
+++ oxide-qt-1.0.0~bzr514/CMakeLists.txt	2014-04-16 10:05:30.743499138 +0100
@@ -107,7 +107,7 @@
   list(APPEND GYP_COMMAND -Dproprietary_codecs=1)
 else()
   list(APPEND GYP_COMMAND -Dffmpeg_branding=Chromium)
-  list(APPEND GYP_COMMAND -Dproprietary_codecs=0)
+  list(APPEND GYP_COMMAND -Dproprietary_codecs=1)
 endif()
 if(DEFINED ENABLE_PLUGINS AND ENABLE_PLUGINS EQUAL 0)
   list(APPEND GYP_COMMAND -Denable_plugins=0)
Index: oxide-qt-1.0.0~bzr514/chromium/src/content/content_renderer.gypi
===================================================================
--- oxide-qt-1.0.0~bzr514.orig/chromium/src/content/content_renderer.gypi	2014-04-16 10:05:30.747499138 +0100
+++ oxide-qt-1.0.0~bzr514/chromium/src/content/content_renderer.gypi	2014-04-16 10:05:30.743499138 +0100
@@ -12,6 +12,7 @@
     '../mojo/mojo.gyp:mojo_js_bindings_lib',
     '../net/net.gyp:net',
     '../skia/skia.gyp:skia',
+    '../third_party/ffmpeg/ffmpeg.gyp:ffmpeg',
     '../third_party/WebKit/public/blink.gyp:blink',
     '../third_party/icu/icu.gyp:icui18n',
     '../third_party/icu/icu.gyp:icuuc',
Index: oxide-qt-1.0.0~bzr514/chromium/src/content/renderer/renderer_webkitplatformsupport_impl.cc
===================================================================
--- oxide-qt-1.0.0~bzr514.orig/chromium/src/content/renderer/renderer_webkitplatformsupport_impl.cc	2014-04-16 10:05:30.747499138 +0100
+++ oxide-qt-1.0.0~bzr514/chromium/src/content/renderer/renderer_webkitplatformsupport_impl.cc	2014-04-16 10:05:30.743499138 +0100
@@ -115,6 +115,12 @@
 #define WebScrollbarBehaviorImpl blink::WebScrollbarBehavior
 #endif
 
+#if defined(USE_PROPRIETARY_CODECS)
+#include "media/ffmpeg/ffmpeg_common.h"
+#include "media/filters/ffmpeg_glue.h"
+#include "third_party/ffmpeg/ffmpeg_stubs.h"
+#endif
+
 using blink::Platform;
 using blink::WebAudioDevice;
 using blink::WebBlobRegistry;
@@ -409,6 +415,15 @@
   if (!net::IsSupportedMediaMimeType(mime_type_ascii))
     return IsNotSupported;
 
+#if defined(USE_PROPRIETARY_CODECS)
+  media::FFmpegGlue::InitializeFFmpeg();
+  if (net::IsProprietaryMediaMimeType(mime_type_ascii) &&
+      !avcodec_find_decoder(AV_CODEC_ID_H264)) {
+    DVLOG(1) << "Proprietary codecs are not installed";
+    return IsNotSupported;
+  }
+#endif
+
   if (!key_system.isEmpty()) {
     // Check whether the key system is supported with the mime_type and codecs.
 
@@ -465,6 +480,16 @@
   net::ParseCodecString(ToASCIIOrEmpty(codecs), &parsed_codec_ids, false);
   if (mime_type_ascii.empty())
     return false;
+
+#if defined(USE_PROPRIETARY_CODECS)
+  media::FFmpegGlue::InitializeFFmpeg();
+  if (net::IsProprietaryMediaMimeType(mime_type_ascii) &&
+      !avcodec_find_decoder(AV_CODEC_ID_H264)) {
+    DVLOG(1) << "Proprietary codecs are not installed";
+    return false;
+  }
+#endif
+
   return media::StreamParserFactory::IsTypeSupported(
       mime_type_ascii, parsed_codec_ids);
 }
Index: oxide-qt-1.0.0~bzr514/chromium/src/net/base/mime_util.cc
===================================================================
--- oxide-qt-1.0.0~bzr514.orig/chromium/src/net/base/mime_util.cc	2014-04-16 10:05:30.747499138 +0100
+++ oxide-qt-1.0.0~bzr514/chromium/src/net/base/mime_util.cc	2014-04-16 10:05:30.743499138 +0100
@@ -1009,6 +1009,15 @@
   return file_type != CERTIFICATE_MIME_TYPE_UNKNOWN;
 }
 
+bool IsProprietaryMediaMimeType(const std::string& mime_type) {
+  for (size_t i = 0; i < arraysize(proprietary_media_types); ++i) {
+    if (mime_type == proprietary_media_types[i]) {
+      return true;
+    }
+  }
+  return false;
+}
+
 void AddMultipartValueForUpload(const std::string& value_name,
                                 const std::string& value,
                                 const std::string& mime_boundary,
Index: oxide-qt-1.0.0~bzr514/chromium/src/net/base/mime_util.h
===================================================================
--- oxide-qt-1.0.0~bzr514.orig/chromium/src/net/base/mime_util.h	2014-04-16 10:05:30.747499138 +0100
+++ oxide-qt-1.0.0~bzr514/chromium/src/net/base/mime_util.h	2014-04-16 10:05:30.743499138 +0100
@@ -46,6 +46,8 @@
 NET_EXPORT bool IsSupportedJavascriptMimeType(const std::string& mime_type);
 NET_EXPORT bool IsSupportedCertificateMimeType(const std::string& mime_type);
 
+NET_EXPORT bool IsProprietaryMediaMimeType(const std::string& mime_type);
+
 // Convenience function.
 NET_EXPORT bool IsSupportedMimeType(const std::string& mime_type);
 
